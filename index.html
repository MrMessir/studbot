<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üéì Student Helper</title>
    
    <!-- Telegram Web App -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- CSS —Å—Ç–∏–ª–∏ -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        body {
            background: #f8f9fa;
            color: #1a1a1a;
            min-height: 100vh;
            padding-bottom: 80px;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü */
        .page {
            display: none;
            padding: 20px;
            animation: fadeIn 0.3s;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .nav-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            display: flex;
            justify-content: space-around;
            padding: 12px 0 20px;
            box-shadow: 0 -4px 12px rgba(0,0,0,0.05);
            border-top: 1px solid #e9ecef;
            z-index: 1000;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            color: #868e96;
            font-size: 12px;
            cursor: pointer;
            transition: 0.2s;
            padding: 4px 12px;
            border-radius: 20px;
        }

        .nav-item.active {
            color: #0d6efd;
            background: #e7f5ff;
        }

        .nav-icon {
            font-size: 24px;
        }

        /* –ó–∞–≥–æ–ª–æ–≤–∫–∏ */
        h1 {
            font-size: 28px;
            margin-bottom: 20px;
            color: #212529;
            font-weight: 600;
        }

        h2 {
            font-size: 18px;
            margin: 20px 0 12px;
            color: #495057;
            font-weight: 500;
        }

        h3 {
            font-size: 16px;
            margin-bottom: 12px;
            color: #495057;
            font-weight: 500;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ */
        .card {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            margin-bottom: 16px;
            border: 1px solid #e9ecef;
        }

        /* –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ */
        .greeting-card {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .avatar {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #0d6efd, #0b5ed7);
            border-radius: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 32px;
            box-shadow: 0 4px 12px rgba(13,110,253,0.3);
        }

        .greeting-text h2 {
            margin: 0 0 4px;
            font-size: 20px;
        }

        .greeting-text p {
            color: #868e96;
            font-size: 14px;
        }

        /* –ü—Ä–æ–≥—Ä–µ—Å—Å */
        .progress-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 10px 0;
        }

        .progress-ring {
            width: 120px;
            height: 120px;
            margin-bottom: 16px;
        }

        .week-stats {
            display: flex;
            justify-content: space-around;
            width: 100%;
            margin-top: 16px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: #0d6efd;
            line-height: 1.2;
        }

        .stat-label {
            font-size: 12px;
            color: #868e96;
        }

        #progressPercent {
            font-size: 32px;
            font-weight: 700;
            color: #0d6efd;
            margin: 8px 0;
        }

        /* –ö–∞–ª–µ–Ω–¥–∞—Ä—å */
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .calendar-month {
            font-size: 20px;
            font-weight: 600;
            color: #212529;
        }

        .calendar-nav {
            display: flex;
            gap: 16px;
        }

        .calendar-nav button {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #0d6efd;
            width: 40px;
            height: 40px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.2s;
        }

        .calendar-nav button:hover {
            background: #e7f5ff;
        }

        .calendar-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            text-align: center;
            font-size: 13px;
            font-weight: 600;
            color: #868e96;
            margin-bottom: 8px;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            border-radius: 12px;
            cursor: pointer;
            background: #f8f9fa;
            transition: 0.2s;
            font-weight: 500;
        }

        .calendar-day.has-lessons {
            background: #cfe2ff;
            color: #0d6efd;
            font-weight: 600;
        }

        .calendar-day.today {
            border: 2px solid #0d6efd;
            font-weight: 700;
        }

        .calendar-day.selected {
            background: #0d6efd;
            color: white;
            font-weight: 600;
        }

        .calendar-day:hover {
            background: #e9ecef;
        }

        .calendar-day.has-lessons:hover {
            background: #b6d4fe;
        }

        /* –°–ø–∏—Å–æ–∫ –ø–∞—Ä */
        .lessons-list {
            margin-top: 20px;
        }

        .lesson-item {
            display: flex;
            align-items: center;
            padding: 16px;
            background: #f8f9fa;
            border-radius: 16px;
            margin-bottom: 8px;
            transition: 0.2s;
            border: 1px solid #e9ecef;
        }

        .lesson-item:hover {
            background: #e9ecef;
        }

        .lesson-time {
            font-weight: 700;
            color: #0d6efd;
            width: 80px;
            font-size: 16px;
        }

        .lesson-info {
            flex: 1;
        }

        .lesson-subject {
            font-weight: 600;
            margin-bottom: 4px;
            font-size: 16px;
        }

        .lesson-details {
            font-size: 13px;
            color: #868e96;
            display: flex;
            gap: 12px;
        }

        .add-lesson-btn {
            width: 100%;
            padding: 16px;
            background: #e7f5ff;
            border: 1px dashed #0d6efd;
            border-radius: 16px;
            color: #0d6efd;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            margin-top: 16px;
            transition: 0.2s;
        }

        .add-lesson-btn:hover {
            background: #d0ebff;
        }

        /* –ó–∞–¥–∞—á–∏ */
        .filters {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-chip {
            padding: 10px 20px;
            background: #f1f3f5;
            border-radius: 30px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: 0.2s;
            border: 1px solid transparent;
        }

        .filter-chip.active {
            background: #0d6efd;
            color: white;
        }

        .filter-chip:hover {
            background: #e9ecef;
        }

        .filter-chip.active:hover {
            background: #0b5ed7;
        }

        .task-item {
            display: flex;
            align-items: flex-start;
            padding: 16px;
            background: white;
            border-radius: 16px;
            margin-bottom: 8px;
            border: 1px solid #e9ecef;
            transition: 0.2s;
        }

        .task-item:hover {
            border-color: #0d6efd;
        }

        .task-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid #ced4da;
            border-radius: 8px;
            margin-right: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: white;
            transition: 0.2s;
            flex-shrink: 0;
        }

        .task-checkbox.checked {
            background: #0d6efd;
            border-color: #0d6efd;
        }

        .task-content {
            flex: 1;
        }

        .task-title {
            font-weight: 600;
            margin-bottom: 6px;
            font-size: 16px;
        }

        .task-meta {
            font-size: 13px;
            color: #868e96;
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }

        .priority-high { color: #dc3545; }
        .priority-medium { color: #fd7e14; }
        .priority-low { color: #20c997; }

        /* –ü—Ä–æ—Ñ–∏–ª—å */
        .profile-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 24px;
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #0d6efd, #0b5ed7);
            border-radius: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 40px;
            box-shadow: 0 4px 12px rgba(13,110,253,0.3);
        }

        .profile-info h2 {
            margin: 0 0 4px;
            font-size: 24px;
        }

        .profile-info p {
            color: #868e96;
            font-size: 14px;
            margin: 2px 0;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin: 20px 0;
        }

        .stat-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 16px;
            text-align: center;
            border: 1px solid #e9ecef;
        }

        .stat-number {
            font-size: 32px;
            font-weight: 700;
            color: #0d6efd;
            line-height: 1.2;
            margin-bottom: 4px;
        }

        .stat-card span {
            font-size: 13px;
            color: #868e96;
        }

        .achievement-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin: 20px 0;
        }

        .achievement {
            text-align: center;
        }

        .achievement-icon {
            width: 60px;
            height: 60px;
            background: #fff3bf;
            border-radius: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 8px;
            font-size: 30px;
            border: 2px solid #ffd966;
        }

        .achievement span {
            font-size: 12px;
            color: #495057;
        }

        .settings-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .settings-item:last-child {
            border-bottom: none;
        }

        .settings-item span {
            font-size: 16px;
            font-weight: 500;
        }

        /* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å */
        .switch {
            position: relative;
            display: inline-block;
            width: 52px;
            height: 28px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .3s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .3s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #0d6efd;
        }

        input:checked + .slider:before {
            transform: translateX(24px);
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
            z-index: 2000;
            backdrop-filter: blur(5px);
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 24px;
            padding: 24px;
            width: 90%;
            max-width: 400px;
            animation: slideUp 0.3s;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal h3 {
            margin-bottom: 20px;
            font-size: 22px;
        }

        .modal input, .modal select {
            width: 100%;
            padding: 14px;
            margin: 8px 0;
            border: 1px solid #ced4da;
            border-radius: 12px;
            font-size: 16px;
            background: #f8f9fa;
        }

        .modal input:focus, .modal select:focus {
            outline: none;
            border-color: #0d6efd;
            background: white;
        }

        .modal-buttons {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        .button {
            flex: 1;
            padding: 16px;
            background: #0d6efd;
            color: white;
            border: none;
            border-radius: 14px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: 0.2s;
        }

        .button:hover {
            background: #0b5ed7;
        }

        .button-outline {
            background: white;
            border: 1px solid #0d6efd;
            color: #0d6efd;
        }

        .button-outline:hover {
            background: #e7f5ff;
        }

        /* –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è */
        .floating-button {
            position: fixed;
            bottom: 100px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 30px;
            background: #0d6efd;
            color: white;
            border: none;
            font-size: 32px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(13, 110, 253, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.2s;
            z-index: 999;
        }

        .floating-button:hover {
            transform: scale(1.1);
        }

        /* –ó–∞–≥—Ä—É–∑–∫–∞ */
        .loading {
            text-align: center;
            padding: 40px;
            color: #868e96;
        }

        .loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #868e96;
            border-top-color: #0d6efd;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 8px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* –ü—É—Å—Ç—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #868e96;
        }

        .empty-state .emoji {
            font-size: 48px;
            margin-bottom: 16px;
        }

        /* –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è */
        .quick-actions {
            display: flex;
            gap: 8px;
            margin-top: 16px;
        }

        .quick-action {
            flex: 1;
            padding: 12px;
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: 0.2s;
        }

        .quick-action:hover {
            background: #e9ecef;
            border-color: #0d6efd;
        }

        .quick-action .emoji {
            font-size: 20px;
            margin-bottom: 4px;
        }

        .quick-action span {
            font-size: 12px;
            color: #495057;
        }
    </style>
</head>
<body>
    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 1: –ì–ª–∞–≤–Ω–∞—è -->
    <div class="page active" id="page1">
        <div class="greeting-card card">
            <div class="avatar" id="userAvatar">üéì</div>
            <div class="greeting-text">
                <h2 id="greeting">–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ, –°—Ç—É–¥–µ–Ω—Ç!</h2>
                <p id="dateToday"></p>
            </div>
        </div>

        <div class="card">
            <h3>üìä –ü—Ä–æ–≥—Ä–µ—Å—Å –Ω–µ–¥–µ–ª–∏</h3>
            <div class="progress-section">
                <div class="progress-ring">
                    <svg width="120" height="120" viewBox="0 0 120 120">
                        <circle cx="60" cy="60" r="54" fill="none" stroke="#e9ecef" stroke-width="8"/>
                        <circle id="progressCircle" cx="60" cy="60" r="54" fill="none" stroke="#0d6efd" stroke-width="8" 
                                stroke-dasharray="339.292" stroke-dashoffset="339.292" transform="rotate(-90 60 60)" style="transition: stroke-dashoffset 0.5s"/>
                    </svg>
                </div>
                <div id="progressPercent">0%</div>
                
                <div class="week-stats">
                    <div class="stat-item">
                        <div class="stat-value" id="lessonsDone">0</div>
                        <div class="stat-label">–ü–∞—Ä</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="tasksDone">0</div>
                        <div class="stat-label">–ó–∞–¥–∞—á</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="daysLeft">0</div>
                        <div class="stat-label">–î–Ω–µ–π</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>üìÖ –°–µ–≥–æ–¥–Ω—è</h3>
            <div id="todaySummary">
                <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
            
            <div class="quick-actions">
                <div class="quick-action" onclick="showAddLessonModal()">
                    <div class="emoji">üìö</div>
                    <span>–î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—É</span>
                </div>
                <div class="quick-action" onclick="showAddTaskModal()">
                    <div class="emoji">üìù</div>
                    <span>–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</span>
                </div>
                <div class="quick-action" onclick="switchPage(2)">
                    <div class="emoji">üìÖ</div>
                    <span>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</span>
                </div>
            </div>
        </div>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 2: –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ -->
    <div class="page" id="page2">
        <h1>üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</h1>
        
        <div class="card">
            <div class="calendar-header">
                <span class="calendar-month" id="currentMonth">–î–µ–∫–∞–±—Ä—å 2024</span>
                <div class="calendar-nav">
                    <button onclick="changeMonth(-1)">‚Üê</button>
                    <button onclick="changeMonth(1)">‚Üí</button>
                </div>
            </div>
            
            <div class="calendar-weekdays">
                <div>–ü–Ω</div>
                <div>–í—Ç</div>
                <div>–°—Ä</div>
                <div>–ß—Ç</div>
                <div>–ü—Ç</div>
                <div>–°–±</div>
                <div>–í—Å</div>
            </div>
            
            <div class="calendar-grid" id="calendar"></div>
        </div>

        <div class="card">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                <h3>–ü–∞—Ä—ã –Ω–∞ <span id="selectedDate"></span></h3>
            </div>
            <div id="lessonsList" class="lessons-list">
                <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
            
            <button class="add-lesson-btn" onclick="showAddLessonModal()">
                ‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—É
            </button>
        </div>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 3: –ó–∞–¥–∞—á–∏ -->
    <div class="page" id="page3">
        <h1>üìù –ó–∞–¥–∞—á–∏</h1>
        
        <div class="filters">
            <div class="filter-chip active" onclick="filterTasks('all')">–í—Å–µ</div>
            <div class="filter-chip" onclick="filterTasks('–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞')">üìê –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞</div>
            <div class="filter-chip" onclick="filterTasks('–§–∏–∑–∏–∫–∞')">‚öõÔ∏è –§–∏–∑–∏–∫–∞</div>
            <div class="filter-chip" onclick="filterTasks('–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ')">üíª –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ</div>
            <div class="filter-chip" onclick="filterTasks('–ê–Ω–≥–ª–∏–π—Å–∫–∏–π')">üåç –ê–Ω–≥–ª–∏–π—Å–∫–∏–π</div>
        </div>

        <div class="card">
            <div id="tasksList">
                <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
            
            <button class="add-lesson-btn" onclick="showAddTaskModal()">
                ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É
            </button>
        </div>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 4: –ü—Ä–æ—Ñ–∏–ª—å -->
    <div class="page" id="page4">
        <h1>üë§ –ü—Ä–æ—Ñ–∏–ª—å</h1>
        
        <div class="card">
            <div class="profile-header">
                <div class="profile-avatar" id="profileAvatar">üéì</div>
                <div class="profile-info">
                    <h2 id="userName">–°—Ç—É–¥–µ–Ω—Ç</h2>
                    <p id="userGroup">–ì—Ä—É–ø–ø–∞: –ù–µ —É–∫–∞–∑–∞–Ω–∞</p>
                    <p id="userSince">–° –Ω–∞–º–∏ —Å: –î–µ–∫ 2024</p>
                </div>
            </div>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="statPairs">0</div>
                <span>–ü–∞—Ä</span>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="statTasks">0</div>
                <span>–ó–∞–¥–∞—á</span>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="statNotes">0</div>
                <span>–ó–∞–º–µ—Ç–æ–∫</span>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="statDays">0</div>
                <span>–î–Ω–µ–π</span>
            </div>
        </div>

        <div class="card">
            <h3>üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h3>
            <div class="achievement-grid" id="achievements">
                <div class="achievement">
                    <div class="achievement-icon">üìö</div>
                    <span>–ü–µ—Ä–≤–∞—è –ø–∞—Ä–∞</span>
                </div>
                <div class="achievement">
                    <div class="achievement-icon">‚úÖ</div>
                    <span>5 –∑–∞–¥–∞—á</span>
                </div>
                <div class="achievement">
                    <div class="achievement-icon">üî•</div>
                    <span>–ù–µ–¥–µ–ª—è</span>
                </div>
                <div class="achievement">
                    <div class="achievement-icon">üìù</div>
                    <span>10 –∑–∞–º–µ—Ç–æ–∫</span>
                </div>
                <div class="achievement">
                    <div class="achievement-icon">üéØ</div>
                    <span>–£—Ä–æ–≤–µ–Ω—å 5</span>
                </div>
                <div class="achievement">
                    <div class="achievement-icon">üèÜ</div>
                    <span>–≠–∫—Å–ø–µ—Ä—Ç</span>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
            
            <div class="settings-item">
                <span>üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                <label class="switch">
                    <input type="checkbox" id="notifications" checked onchange="toggleSetting('notifications')">
                    <span class="slider"></span>
                </label>
            </div>
            
            <div class="settings-item">
                <span>üåô –¢–µ–º–Ω–∞—è —Ç–µ–º–∞</span>
                <label class="switch">
                    <input type="checkbox" id="darkTheme" onchange="toggleSetting('darkTheme')">
                    <span class="slider"></span>
                </label>
            </div>
            
            <div class="settings-item">
                <span>üìÖ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –ø–∞—Ä–∞—Ö</span>
                <label class="switch">
                    <input type="checkbox" id="lessonReminders" checked onchange="toggleSetting('lessonReminders')">
                    <span class="slider"></span>
                </label>
            </div>
            
            <div class="settings-item">
                <span>üìù –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –¥–µ–¥–ª–∞–π–Ω–∞—Ö</span>
                <label class="switch">
                    <input type="checkbox" id="deadlineReminders" checked onchange="toggleSetting('deadlineReminders')">
                    <span class="slider"></span>
                </label>
            </div>
        </div>
    </div>

    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="nav-bar">
        <div class="nav-item active" onclick="switchPage(1)">
            <span class="nav-icon">üè†</span>
            <span>–ì–ª–∞–≤–Ω–∞—è</span>
        </div>
        <div class="nav-item" onclick="switchPage(2)">
            <span class="nav-icon">üìÖ</span>
            <span>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</span>
        </div>
        <div class="nav-item" onclick="switchPage(3)">
            <span class="nav-icon">üìù</span>
            <span>–ó–∞–¥–∞—á–∏</span>
        </div>
        <div class="nav-item" onclick="switchPage(4)">
            <span class="nav-icon">üë§</span>
            <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
        </div>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∞ –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è -->
    <button class="floating-button" onclick="showQuickAddMenu()">‚ûï</button>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ä—ã -->
    <div class="modal" id="addLessonModal">
        <div class="modal-content">
            <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—É</h3>
            <input type="text" id="lessonSubject" placeholder="–ü—Ä–µ–¥–º–µ—Ç" required>
            <input type="time" id="lessonTime" required>
            <input type="text" id="lessonRoom" placeholder="–ê—É–¥–∏—Ç–æ—Ä–∏—è" required>
            <input type="text" id="lessonTeacher" placeholder="–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å" required>
            
            <div class="modal-buttons">
                <button class="button" onclick="addLesson()">–î–æ–±–∞–≤–∏—Ç—å</button>
                <button class="button button-outline" onclick="closeModal('addLessonModal')">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ -->
    <div class="modal" id="addTaskModal">
        <div class="modal-content">
            <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</h3>
            <input type="text" id="taskSubject" placeholder="–ü—Ä–µ–¥–º–µ—Ç" required>
            <input type="text" id="taskDescription" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ" required>
            <input type="date" id="taskDeadline" required>
            <select id="taskPriority">
                <option value="high">üî¥ –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                <option value="medium">üü° –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                <option value="low">üü¢ –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
            </select>
            
            <div class="modal-buttons">
                <button class="button" onclick="addTask()">–î–æ–±–∞–≤–∏—Ç—å</button>
                <button class="button button-outline" onclick="closeModal('addTaskModal')">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è -->
    <div class="modal" id="quickAddModal">
        <div class="modal-content">
            <h3>üìå –ë—ã—Å—Ç—Ä–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ</h3>
            <div style="display: flex; flex-direction: column; gap: 12px;">
                <button class="button" onclick="showAddLessonModal(); closeModal('quickAddModal')">
                    üìö –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—É
                </button>
                <button class="button" onclick="showAddTaskModal(); closeModal('quickAddModal')">
                    üìù –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É
                </button>
                <button class="button button-outline" onclick="closeModal('quickAddModal')">
                    –û—Ç–º–µ–Ω–∞
                </button>
            </div>
        </div>
    </div>

    <!-- JavaScript –∫–æ–¥ -->
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();

        // –ü–æ–ª—É—á–∞–µ–º userId –∏–∑ URL (–¥–ª—è GitHub Pages)
        const urlParams = new URLSearchParams(window.location.search);
        const userId = urlParams.get('userId') || 'test_user';

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        let state = {
            user: {
                name: '–°—Ç—É–¥–µ–Ω—Ç',
                group: '–ù–µ —É–∫–∞–∑–∞–Ω–∞',
                registeredAt: new Date().toISOString(),
                settings: {
                    notifications: true,
                    darkTheme: false,
                    lessonReminders: true,
                    deadlineReminders: true
                }
            },
            lessons: [],
            deadlines: [],
            currentMonth: new Date(),
            selectedDate: new Date().toISOString().split('T')[0],
            currentFilter: 'all'
        };

        // ==================== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –†–ê–ë–û–¢–´ –° –ë–û–¢–û–ú ====================

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –±–æ—Ç—É
        function sendToBot(action, data = {}) {
            const message = JSON.stringify({
                action: action,
                ...data
            });
            
            if (tg) {
                tg.sendData(message);
                console.log('üì§ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –±–æ—Ç—É:', message);
            } else {
                console.log('üì¶ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º:', message);
                // –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ Telegram
                alert(`–î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã: ${action}`);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ—Ç –±–æ—Ç–∞ (–≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–¥—É—Ç —á–µ—Ä–µ–∑ initData)
        function loadUserData() {
            // –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ initData
            if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
                state.user.name = tg.initDataUnsafe.user.first_name || '–°—Ç—É–¥–µ–Ω—Ç';
            }
            
            // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ —É –±–æ—Ç–∞
            sendToBot('get_data', { userId });
            
            // –ü–æ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
            setTimeout(() => {
                loadTestData();
            }, 1000);
        }

        // –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
        function loadTestData() {
            const today = new Date().toISOString().split('T')[0];
            const tomorrow = new Date(Date.now() + 86400000).toISOString().split('T')[0];
            
            state.lessons = [
                { id: 1, date: today, time: '10:00', subject: '–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞', room: '301', teacher: '–ò–≤–∞–Ω–æ–≤ –ò.–ò.' },
                { id: 2, date: today, time: '12:00', subject: '–§–∏–∑–∏–∫–∞', room: '205', teacher: '–ü–µ—Ç—Ä–æ–≤ –ü.–ü.' },
                { id: 3, date: tomorrow, time: '09:00', subject: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ', room: '410', teacher: '–°–∏–¥–æ—Ä–æ–≤ –°.–°.' },
                { id: 4, date: tomorrow, time: '11:00', subject: '–ê–Ω–≥–ª–∏–π—Å–∫–∏–π', room: '115', teacher: '–°–º–∏—Ä–Ω–æ–≤–∞ –ï.–ê.' }
            ];
            
            state.deadlines = [
                { id: 1, subject: '–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞', task: '–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞', date: tomorrow, priority: 'high', completed: false },
                { id: 2, subject: '–§–∏–∑–∏–∫–∞', task: '–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è', date: tomorrow, priority: 'medium', completed: false },
                { id: 3, subject: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ', task: '–ö—É—Ä—Å–æ–≤–∞—è', date: '2024-12-25', priority: 'high', completed: false },
                { id: 4, subject: '–ê–Ω–≥–ª–∏–π—Å–∫–∏–π', task: '–≠—Å—Å–µ', date: '2024-12-20', priority: 'low', completed: true }
            ];
            
            updateUI();
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ–π –ø–∞—Ä—ã
        function saveLesson(lesson) {
            const newLesson = {
                id: state.lessons.length + 1,
                date: state.selectedDate,
                ...lesson
            };
            
            state.lessons.push(newLesson);
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –±–æ—Ç—É
            sendToBot('add_lesson', { lesson: newLesson });
            
            updateUI();
            closeModal('addLessonModal');
            
            tg.showAlert('‚úÖ –ü–∞—Ä–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞!');
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –¥–µ–¥–ª–∞–π–Ω–∞
        function saveDeadline(deadline) {
            const newDeadline = {
                id: state.deadlines.length + 1,
                completed: false,
                ...deadline
            };
            
            state.deadlines.push(newDeadline);
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –±–æ—Ç—É
            sendToBot('add_deadline', { deadline: newDeadline });
            
            updateUI();
            closeModal('addTaskModal');
            
            tg.showAlert('‚úÖ –ó–∞–¥–∞—á–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞!');
        }

        // –û—Ç–º–µ—Ç–∫–∞ –¥–µ–¥–ª–∞–π–Ω–∞ –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–≥–æ
        function completeDeadline(id) {
            const deadline = state.deadlines.find(d => d.id === id);
            if (deadline) {
                deadline.completed = true;
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –±–æ—Ç—É
                sendToBot('complete_deadline', { id });
                
                updateUI();
                tg.showAlert('‚úÖ –ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞! –ú–æ–ª–æ–¥–µ—Ü! üéâ');
            }
        }

        // ==================== –ù–ê–í–ò–ì–ê–¶–ò–Ø ====================

        function switchPage(pageNum) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(`page${pageNum}`).classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach((item, index) => {
                if (index === pageNum - 1) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });

            if (pageNum === 1) updateHomePage();
            if (pageNum === 2) updateCalendar();
            if (pageNum === 3) updateTasksList();
        }

        // ==================== –ì–õ–ê–í–ù–ê–Ø –°–¢–†–ê–ù–ò–¶–ê ====================

        function updateHomePage() {
            const now = new Date();
            const hours = now.getHours();
            let greeting = '';
            
            if (hours < 12) greeting = '–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ';
            else if (hours < 18) greeting = '–î–æ–±—Ä—ã–π –¥–µ–Ω—å';
            else greeting = '–î–æ–±—Ä—ã–π –≤–µ—á–µ—Ä';
            
            document.getElementById('greeting').innerHTML = `${greeting}, ${state.user.name}! üëã`;
            document.getElementById('dateToday').innerHTML = now.toLocaleDateString('ru-RU', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });

            // –ü—Ä–æ–≥—Ä–µ—Å—Å –Ω–µ–¥–µ–ª–∏
            const weekProgress = calculateWeekProgress();
            document.getElementById('progressPercent').innerHTML = weekProgress.percent + '%';
            
            const circle = document.getElementById('progressCircle');
            const circumference = 2 * Math.PI * 54;
            const offset = circumference - (weekProgress.percent / 100) * circumference;
            circle.style.strokeDashoffset = offset;

            document.getElementById('lessonsDone').innerHTML = weekProgress.lessonsDone;
            document.getElementById('tasksDone').innerHTML = weekProgress.tasksDone;
            document.getElementById('daysLeft').innerHTML = weekProgress.daysLeft;

            // –°–µ–≥–æ–¥–Ω—è—à–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
            const todayStr = now.toISOString().split('T')[0];
            const todayLessons = state.lessons.filter(l => l.date === todayStr);
            const todayTasks = state.deadlines.filter(d => d.date === todayStr && !d.completed);

            let summary = '';
            if (todayLessons.length === 0 && todayTasks.length === 0) {
                summary = '<div class="empty-state"><div class="emoji">üéâ</div><p>–°–µ–≥–æ–¥–Ω—è –Ω–∏—á–µ–≥–æ –Ω–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ. –û—Ç–¥—ã—Ö–∞–π!</p></div>';
            } else {
                summary = '<div style="display: flex; flex-direction: column; gap: 8px;">';
                
                if (todayLessons.length > 0) {
                    summary += `<div style="display: flex; align-items: center; gap: 8px;">
                        <span style="font-size: 24px;">üìö</span>
                        <span><strong>${todayLessons.length}</strong> –ø–∞—Ä(—ã)</span>
                    </div>`;
                    
                    todayLessons.slice(0, 2).forEach(l => {
                        summary += `<div style="margin-left: 32px; font-size: 13px; color: #495057;">
                            ‚Ä¢ ${l.time} - ${l.subject} (${l.room})
                        </div>`;
                    });
                    
                    if (todayLessons.length > 2) {
                        summary += `<div style="margin-left: 32px; font-size: 13px; color: #868e96;">
                            –∏ –µ—â—ë ${todayLessons.length - 2}...
                        </div>`;
                    }
                }
                
                if (todayTasks.length > 0) {
                    summary += `<div style="display: flex; align-items: center; gap: 8px; margin-top: 8px;">
                        <span style="font-size: 24px;">‚è∞</span>
                        <span><strong>${todayTasks.length}</strong> –¥–µ–¥–ª–∞–π–Ω(–æ–≤)</span>
                    </div>`;
                    
                    todayTasks.slice(0, 2).forEach(t => {
                        const emoji = t.priority === 'high' ? 'üî¥' : t.priority === 'medium' ? 'üü°' : 'üü¢';
                        summary += `<div style="margin-left: 32px; font-size: 13px; color: #495057;">
                            ‚Ä¢ ${emoji} ${t.subject} - ${t.task}
                        </div>`;
                    });
                }
                
                summary += '</div>';
            }
            
            document.getElementById('todaySummary').innerHTML = summary;
        }

        function calculateWeekProgress() {
            const now = new Date();
            const startOfWeek = new Date(now);
            startOfWeek.setDate(now.getDate() - now.getDay() + 1);
            const endOfWeek = new Date(startOfWeek);
            endOfWeek.setDate(startOfWeek.getDate() + 6);

            const weekLessons = state.lessons.filter(l => {
                const d = new Date(l.date);
                return d >= startOfWeek && d <= endOfWeek;
            });

            const weekTasks = state.deadlines.filter(d => {
                const date = new Date(d.date);
                return date >= startOfWeek && date <= endOfWeek;
            });

            const dayOfWeek = now.getDay() || 7;
            const percent = Math.round((dayOfWeek / 7) * 100);

            return {
                percent: percent,
                lessonsDone: weekLessons.length,
                tasksDone: weekTasks.filter(t => t.completed).length,
                daysLeft: 7 - dayOfWeek
            };
        }

        // ==================== –ö–ê–õ–ï–ù–î–ê–†–¨ ====================

        function updateCalendar() {
            const year = state.currentMonth.getFullYear();
            const month = state.currentMonth.getMonth();
            
            document.getElementById('currentMonth').innerHTML = 
                state.currentMonth.toLocaleDateString('ru-RU', { month: 'long', year: 'numeric' });

            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            
            let calendarHTML = '';
            
            // –ü—É—Å—Ç—ã–µ —è—á–µ–π–∫–∏ –¥–æ –ø–µ—Ä–≤–æ–≥–æ –¥–Ω—è
            const firstDayIndex = firstDay.getDay() || 7;
            for (let i = 1; i < firstDayIndex; i++) {
                calendarHTML += '<div class="calendar-day"></div>';
            }
            
            // –î–Ω–∏ –º–µ—Å—è—Ü–∞
            for (let d = 1; d <= lastDay.getDate(); d++) {
                const date = new Date(year, month, d);
                const dateStr = date.toISOString().split('T')[0];
                const hasLessons = state.lessons.some(l => l.date === dateStr);
                const isToday = dateStr === new Date().toISOString().split('T')[0];
                const isSelected = dateStr === state.selectedDate;
                
                calendarHTML += `<div class="calendar-day ${hasLessons ? 'has-lessons' : ''} ${isToday ? 'today' : ''} ${isSelected ? 'selected' : ''}" 
                                onclick="selectDate('${dateStr}')">${d}</div>`;
            }
            
            document.getElementById('calendar').innerHTML = calendarHTML;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–∞—Ä—ã –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∞—Ç—É
            showLessonsForDate(state.selectedDate);
        }

        function changeMonth(delta) {
            state.currentMonth.setMonth(state.currentMonth.getMonth() + delta);
            updateCalendar();
        }

        function selectDate(dateStr) {
            state.selectedDate = dateStr;
            updateCalendar();
        }

        function showLessonsForDate(dateStr) {
            const dateLessons = state.lessons.filter(l => l.date === dateStr);
            const formattedDate = new Date(dateStr).toLocaleDateString('ru-RU', { 
                day: 'numeric', 
                month: 'long' 
            });
            
            document.getElementById('selectedDate').innerHTML = formattedDate;
            
            let lessonsHTML = '';
            if (dateLessons.length === 0) {
                lessonsHTML = '<div class="empty-state"><div class="emoji">üì≠</div><p>–ü–∞—Ä –Ω–µ—Ç</p></div>';
            } else {
                dateLessons.sort((a, b) => a.time.localeCompare(b.time));
                dateLessons.forEach(lesson => {
                    lessonsHTML += `
                        <div class="lesson-item">
                            <div class="lesson-time">${lesson.time}</div>
                            <div class="lesson-info">
                                <div class="lesson-subject">${lesson.subject}</div>
                                <div class="lesson-details">
                                    <span>üè¢ ${lesson.room}</span>
                                    <span>üë®‚Äçüè´ ${lesson.teacher}</span>
                                </div>
                            </div>
                        </div>
                    `;
                });
            }
            
            document.getElementById('lessonsList').innerHTML = lessonsHTML;
        }

        // ==================== –ó–ê–î–ê–ß–ò ====================

        function updateTasksList() {
            let filteredTasks = state.deadlines;
            if (state.currentFilter !== 'all') {
                filteredTasks = state.deadlines.filter(d => 
                    d.subject.toLowerCase().includes(state.currentFilter.toLowerCase())
                );
            }
            
            filteredTasks.sort((a, b) => new Date(a.date) - new Date(b.date));
            
            let tasksHTML = '';
            if (filteredTasks.length === 0) {
                tasksHTML = '<div class="empty-state"><div class="emoji">‚úÖ</div><p>–ó–∞–¥–∞—á –Ω–µ—Ç</p></div>';
            } else {
                filteredTasks.forEach(task => {
                    const daysLeft = Math.ceil((new Date(task.date) - new Date()) / (1000 * 60 * 60 * 24));
                    const priorityClass = `priority-${task.priority}`;
                    const priorityEmoji = task.priority === 'high' ? 'üî¥' : task.priority === 'medium' ? 'üü°' : 'üü¢';
                    const daysText = daysLeft < 0 ? 'üî• –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ' : 
                                   daysLeft === 0 ? 'üö® –°–µ–≥–æ–¥–Ω—è' : 
                                   daysLeft === 1 ? '‚è∞ –ó–∞–≤—Ç—Ä–∞' : 
                                   `‚è∞ ${daysLeft} –¥–Ω.`;
                    
                    tasksHTML += `
                        <div class="task-item">
                            <div class="task-checkbox ${task.completed ? 'checked' : ''}" 
                                 onclick="completeDeadline(${task.id})">
                                ${task.completed ? '‚úì' : ''}
                            </div>
                            <div class="task-content">
                                <div class="task-title">${task.subject} - ${task.task}</div>
                                <div class="task-meta">
                                    <span class="${priorityClass}">${priorityEmoji} ${task.priority}</span>
                                    <span>üìÖ ${new Date(task.date).toLocaleDateString('ru-RU')}</span>
                                    <span style="color: ${daysLeft < 2 ? '#dc3545' : '#868e96'}">${daysText}</span>
                                </div>
                            </div>
                        </div>
                    `;
                });
            }
            
            document.getElementById('tasksList').innerHTML = tasksHTML;
        }

        function filterTasks(filter) {
            state.currentFilter = filter;
            document.querySelectorAll('.filter-chip').forEach(chip => {
                chip.classList.remove('active');
                if (chip.innerText.includes(filter) || 
                    (filter === 'all' && chip.innerText === '–í—Å–µ')) {
                    chip.classList.add('active');
                }
            });
            updateTasksList();
        }

        // ==================== –ü–†–û–§–ò–õ–¨ ====================

        function updateProfile() {
            document.getElementById('userName').innerHTML = state.user.name;
            document.getElementById('userGroup').innerHTML = `–ì—Ä—É–ø–ø–∞: ${state.user.group}`;
            
            const registeredDate = new Date(state.user.registeredAt);
            document.getElementById('userSince').innerHTML = `–° –Ω–∞–º–∏ —Å: ${registeredDate.toLocaleDateString('ru-RU', { month: 'short', year: 'numeric' })}`;
            
            document.getElementById('statPairs').innerHTML = state.lessons.length;
            document.getElementById('statTasks').innerHTML = state.deadlines.filter(d => !d.completed).length;
            document.getElementById('statNotes').innerHTML = 0;
            document.getElementById('statDays').innerHTML = Math.floor((new Date() - registeredDate) / (1000 * 60 * 60 * 24));
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
            document.getElementById('notifications').checked = state.user.settings.notifications;
            document.getElementById('lessonReminders').checked = state.user.settings.lessonReminders;
            document.getElementById('deadlineReminders').checked = state.user.settings.deadlineReminders;
        }

        function toggleSetting(setting) {
            const value = document.getElementById(setting).checked;
            state.user.settings[setting] = value;
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –±–æ—Ç—É
            sendToBot('update_settings', { setting, value });
            
            tg.showAlert(`‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞`);
        }

        // ==================== –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê ====================

        function showAddLessonModal() {
            document.getElementById('addLessonModal').classList.add('active');
        }

        function showAddTaskModal() {
            document.getElementById('addTaskModal').classList.add('active');
        }

        function showQuickAddMenu() {
            document.getElementById('quickAddModal').classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function addLesson() {
            const subject = document.getElementById('lessonSubject').value;
            const time = document.getElementById('lessonTime').value;
            const room = document.getElementById('lessonRoom').value;
            const teacher = document.getElementById('lessonTeacher').value;
            
            if (subject && time && room && teacher) {
                saveLesson({
                    subject: subject,
                    time: time,
                    room: room,
                    teacher: teacher
                });
                
                // –û—á–∏—Å—Ç–∏—Ç—å –ø–æ–ª—è
                document.getElementById('lessonSubject').value = '';
                document.getElementById('lessonTime').value = '';
                document.getElementById('lessonRoom').value = '';
                document.getElementById('lessonTeacher').value = '';
            } else {
                tg.showAlert('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
            }
        }

        function addTask() {
            const subject = document.getElementById('taskSubject').value;
            const description = document.getElementById('taskDescription').value;
            const deadline = document.getElementById('taskDeadline').value;
            const priority = document.getElementById('taskPriority').value;
            
            if (subject && description && deadline) {
                saveDeadline({
                    subject: subject,
                    task: description,
                    date: deadline,
                    priority: priority
                });
                
                // –û—á–∏—Å—Ç–∏—Ç—å –ø–æ–ª—è
                document.getElementById('taskSubject').value = '';
                document.getElementById('taskDescription').value = '';
                document.getElementById('taskDeadline').value = '';
            } else {
                tg.showAlert('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ–≥–æ UI
        function updateUI() {
            updateHomePage();
            updateCalendar();
            updateTasksList();
            updateProfile();
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        window.onload = function() {
            loadUserData();
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.classList.remove('active');
                    }
                });
            });
        };
    </script>
</body>
</html>